{
  "description": "BIP-375 Test Vectors",
  "version": "1.1",
  "format_notes": [
    "All keys are hex-encoded",
    "PSBTs have all necessary fields",
    "Test vectors are organized into 'invalid' and 'valid' arrays"
  ],
  "invalid": [
    {
      "description": "Detect missing PSBT_IN_SP_DLEQ proof field for PSBT_IN_SP_ECDH_SHARE",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiCrtYht20vGCALx8ZiisSkDZZzJ7nPgIx1FVehBiNyWQAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8BAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAXu7qlEuAw+8o+5RT3sjgH4RGDGkdFRHCRNMn5v0a2xAEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "abb5886ddb4bc60802f1f198a2b12903659cc9ee73e0231d4555e84188dc9640",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": null,
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "512017bbbaa512e030fbca3ee514f7b23807e111831a474544709134c9f9bf46b6c4",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect invalid DLEQ proof in PSBT_IN_SP_DLEQ field",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiBJpgB4JAmRsNt6srOq9JqFCEYGmw7mPo8/4lJ2+/nPoAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8iHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+ECB1dab73m7/xP6o4gDeMISP8SUJ7Lb0cTBayb1WDeYZi1u5ekG4K3g7oO2Cor11Y5A758GvXy2nF0tx1E7u/5hAQMEAQAAAAABAwgYcwEAAAAAAAEEIlEgsuRy0TOUWM9fKDzk0MnUwzY/UdSp9SkkH4SdztRbddABCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "49a60078240991b0db7ab2b3aaf49a850846069b0ee63e8f3fe25276fbf9cfa0",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "81d5d69bef79bbff13faa3880378c2123fc49427b2dbd1c4c16b26f5583798662d6ee5e906e0ade0ee83b60a8af5d58e40ef9f06bd7cb69c5d2dc7513bbbfe61",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120b2e472d1339458cf5f283ce4d0c9d4c3363f51d4a9f529241f849dced45b75d0",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with non-SIGHASH_ALL signatures and PSBT_OUT_SP_V0_INFO field set",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiCfF8iU72tyS4+7lJj0TTc8KFCARRz/QDHgOTLIuPm2twEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQCAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAfNn2bwSJU+NoXtyj8XaZFSWYvOykbyFO0rjN/aSdtqAHj4lLZt/ZimcG5oc68kn132TsyYRE6RNyl32W+tgrQwABAwgYcwEAAAAAAAEEIlEgdE4JlR8XtYJIPHoMCMBib+rDZmk8hPrzngNLYS3o3HEBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "9f17c894ef6b724b8fbb9498f44d373c285080451cff4031e03932c8b8f9b6b7",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "7cd9f66f048953e3685edca3f17699152598bceca46f214ed2b8cdfda49db6a0078f894b66dfd98a6706e6873af249f5df64ecc98444e91372977d96fad82b43",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120744e09951f17b582483c7a0c08c0626feac366693c84faf39e034b612de8dc71",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect segwit version greater than 1 in transaction inputs with PSBT_OUT_SP_V0_INFO field set",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiCuv6p7LnQnsTi6F7UesBJ3TJOXBoHuPhb2Y3hjUklAJAEPBAAAAAABASughgEAAAAAACJSIIYiz2yIzTx5hSOFG+T1WYNgEYY+sDBYObtzXueh9KPpARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgIZ6/eW18O5peg4tLa+KXfHTrjWr+b09YgAaz1sNh63wBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "aebfaa7b2e7427b138ba17b51eb012774c93970681ee3e16f663786352494024",
          "prevout_index": 0,
          "prevout_scriptpubkey": "52208622cf6c88cd3c798523851be4f559836011863eb0305839bb735ee7a1f4a3e9",
          "amount": 100000,
          "witness_utxo": "a0860100000000002252208622cf6c88cd3c798523851be4f559836011863eb0305839bb735ee7a1f4a3e9",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120219ebf796d7c3b9a5e838b4b6be2977c74eb8d6afe6f4f588006b3d6c361eb7c",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect missing PSBT_IN_SP_ECDH_SHARE with silent payment outputs defined",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiAkKwMCMdEgYFJ2eRmpLxfpzUNydadt47rD+2VnyyekwwEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAE49PFUgTAYIPf3lo2ltGczidvHq5eXgsw3uhama8pVgEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "242b030231d1206052767919a92f17e9cd437275a76de3bac3fb6567cb27a4c3",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "512004e3d3c55204c06083dfde5a3696d19cce276f1eae5e5e0b30dee85a99af2956",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with only ineligible P2WSH inputs - no eligible input types for silent payments",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiDu9NOQl4Oy2HFWwseeq/yfrGBbQrpIntF0YwuPb61QngEPBAAAAAABASughgEAAAAAACIAIApf3pCUxvcIoVLGRyDYCI31zASjvp4yse/MxUxOjCccARAE/v///wEFR1IhA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NIQKPHQgtYAH6S6iZpAPa+bHbAb6SXCJTOvYw7mSTsL6feVKuAAEDCJBfAQAAAAAAAQlCAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4Ak1Rg1P0vRjXac9o/2LvEGabcIYkawpkA/5XveSSEUSLAA==",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "eef4d3909783b2d87156c2c79eabfc9fac605b42ba489ed174630b8f6fad509e",
          "prevout_index": 0,
          "prevout_scriptpubkey": "00200a5fde9094c6f708a152c64720d8088df5cc04a3be9e32b1efccc54c4e8c271c",
          "amount": 100000,
          "witness_utxo": "a0860100000000002200200a5fde9094c6f708a152c64720d8088df5cc04a3be9e32b1efccc54c4e8c271c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 90000,
          "is_silent_payment": true,
          "script": null,
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": "e97326ecf3f4e7f16b619d17ded48dc76ce0e4b6394d11fc92800cb8e09d66f5"
    },
    {
      "description": "Detect missing PSBT_GLOBAL_SP_DLEQ proof field matching PSBT_GLOBAL_SP_ECDH_SHARE",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBACIHAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQJVFk55JtUNUqCf+ZBkel6Vwdsb/GimFvvC2iE5J/mL/wABDiD2W3/BmfoPsrzNsfoGEte1D2K0+PqV1WXEoB9MWC6SpAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSCBAAI55HC7UjfZ+r6wGeJ5j8RXLnnJOQtdHV42G7fgIAEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "f65b7fc199fa0fb2bccdb1fa0612d7b50f62b4f8fa95d565c4a01f4c582e92a4",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": null,
          "input_index": null
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "512081000239e470bb5237d9fabeb019e2798fc4572e79c9390b5d1d5e361bb7e020",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect PSBT_OUT_SP_V0_INFO field with incorrect size",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiBhb07a0EqylXgp4bK5tBHX2y2Sc2xQAy4NalHiyZy13gEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgqx9NHhF5eGF2DneK22zBZvlqth3Rr4eZ5lH0FTIh7JMBCUEC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRAA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "616f4edad04ab2957829e1b2b9b411d7db2d92736c50032e0d6a51e2c99cb5de",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120ab1f4d1e11797861760e778adb6cc166f96ab61dd1af8799e651f4153221ec93",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde4921144",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect PSBT_IN_SP_ECDH_SHARE field with incorrect size",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiC1ovhHRrNOgzq0ftE7S5hwtBwhRvo0a3NKnEftiiROwwEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPggAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+YsiHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+EDB1n84eIK/gXkV6hWCHWTVs4NcH8BcVYzj2CSSoX2QjBBIfbub3cEIDIwtnBlxsmYIPGkFTiIZPyRBKKxmc35gAAEDCBhzAQAAAAAAAQQiUSCAMJJILyYp0p2YWRCwgsaMogfA7UA9jYewHOnTv3H4AQEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "b5a2f84746b34e833ab47ed13b4b9870b41c2146fa346b734a9c47ed8a244ec3",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120803092482f2629d29d985910b082c68ca207c0ed403d8d87b01ce9d3bf71f801",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect PSBT_IN_SP_DLEQ proof field with incorrect size",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiA78BpakVw0yvjzRht09tYBDcMoUSAE43p653aHic5dEwEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPg/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEDCBhzAQAAAAAAAQQiUSDtdP0G8Hjd7PFuoDosE3hSYzYMLSEIV++xEaqAMWmt+wEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "3bf01a5a915c34caf8f3461b74f6d6010dc328512004e37a7ae7768789ce5d13",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120ed74fd06f078ddecf16ea03a2c13785263360c2d210857efb111aa803169adfb",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect PSBT_OUT_SP_V0_LABEL field present without required PSBT_OUT_SP_V0_INFO field",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiCYIQIrPQiMfZ8vxvALHE0JCEOOoHYl2kTD+2DBdIFEqgEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAAAQMIGHMBAAAAAAABBCJRICPE97d2KoVw4KmW77zDea7n/IowriFuMhY4RHSeKDQ7AQoEAQAAAAA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "9821022b3d088c7d9f2fc6f00b1c4d0908438ea07625da44c3fb60c1748144aa",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [],
      "expected_ecdh_shares": [],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": false,
          "script": "512023c4f7b7762a8570e0a996efbcc379aee7fc8a30ae216e32163844749e28343b",
          "sp_info": null,
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Detect computed output script mismatch in PSBT_OUT_SCRIPT field from transaction inputs and PSBT_IN_SP_ECDH_SHARE field",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAAABDiBumss8ldbK7k1KciUCaeuPPQVy7U+E9Lf8M6mavj46BQEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwgYcwEAAAAAAAEEIlEgzeOdiwW0lvjxjyCyfQr5oyMzCeBHIhnggT/ztdN4fikBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "6e9acb3c95d6caee4d4a72250269eb8f3d0572ed4f84f4b7fc33a99abe3e3a05",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120cde39d8b05b496f8f18f20b27d0af9a3233309e0472219e0813ff3b5d3787e29",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with incomplete ECDH coverage when PSBT_OUT_SCRIPT is set: 2 eligible inputs but only input 0 has ECDH share",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAIAAAABBQQBAAAAAQYBAAABDiAT0u662aEJkUdBDIam/gsg7p23WdpBz9Tul5LNUBI3FQEPBAAAAAABAR9QwwAAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABDiAlbK6m2hWAb7hW7a50mI1EDHqxtcCGHsgR0ZCSdHudHAEPBAAAAAABAR9QwwAAAAAAABYAFEIccVrt+YOvDjtnb/fElNEFT826ARAE/v///yIGAo8dCC1gAfpLqJmkA9r5sdsBvpJcIlM69jDuZJOwvp95BAAAAAABAwQBAAAAAAEDCBhzAQAAAAAAAQQiUSAieje9mi7ioDshIpPzsiG8ArYuiNCFgfP7zAr+GgECTwEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "13d2eebad9a1099147410c86a6fe0b20ee9db759da41cfd4ee9792cd50123715",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        },
        {
          "input_index": 1,
          "private_key": "b0d095ddc9d046be37f1f083e2993b2c7ace820a0696c730d930a4eba61fc056",
          "public_key": "028f1d082d6001fa4ba899a403daf9b1db01be925c22533af630ee6493b0be9f79",
          "prevout_txid": "256caea6da15806fb856edae74988d440c7ab1b5c0861ec811d19092747b9d1c",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120227a37bd9a2ee2a03b212293f3b221bc02b62e88d08581f3fbcc0afe1a01024f",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with PSBT_OUT_SCRIPT set but PSBT_GLOBAL_TX_MODIFIABLE is modifiable",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBAyIHAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQJVFk55JtUNUqCf+ZBkel6Vwdsb/GimFvvC2iE5J/mL/yIIAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4QMHWfzh4gr+BeRXqFYIdZNWzg1wfwFxVjOPYJJKhfZCMEEh9u5vdwQgMjC2cGXGyZgg8aQVOIhk/JEEorGZzfmAAAQ4go6YQQ0Q/Rs04nKNNzImIKUpb2vp/Ekx4SCcyJtmUFkgBDwQAAAAAAQEfoIYBAAAAAAAWABT42vdq2AOw76ldbP+K7giR068cjAEQBP7///8iBgPTV/fAcY8keOP9j4zMJynd2MDMrrHwKxgab0TUO5+NjQQAAAAAAAEDCBhzAQAAAAAAAQQiUSC2m8R76sGcucAyMHwqkz2WhbI4G4He5nXdEaA96KE0gwEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "a3a61043443f46cd389ca34dcc8988294a5bdafa7f124c7848273226d9941648",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": null
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120b69bc47beac19cb9c032307c2a933d9685b2381b81dee675dd11a03de8a13483",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with two silent payment outputs (different scan keys) where ECDH share is missing for one scan key",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQCAAAAAQYBAAABDiA7SjrPkJNhHFUvAMjD7v1seuDtK0FxkcHEMQE4Mu7GNgEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwjIrwAAAAAAAAEEIlEg3aDH4jeseh6+dH9agxz5MxMgDSxQyrbPl31zfZVeDr8BCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsAAQMIyK8AAAAAAAABBCJRIDc7HAHr9lMJM7SfwBEtJCc3zgRbxnKTyclZ+BlLnxljAQlCAq4tbHYuKGfUiAJ3HG0uaAbfXTc2YqnBIoDPMLs1CaE6A/I10XQ+qxFTs6TSFwcQ4J+2U0bL3iYunbKRAfg8KbgnAA==",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "3b4a3acf9093611c552f00c8c3eefd6c7ae0ed2b417191c1c431013832eec636",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        },
        {
          "scan_pubkey": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "spend_pubkey": "03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "5120dda0c7e237ac7a1ebe747f5a831cf93313200d2c50cab6cf977d737d955e0ebf",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        },
        {
          "output_index": 1,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "5120373b1c01ebf6530933b49fc0112d242737ce045bc67293c9c959f8194b9f1963",
          "sp_info": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with two silent payment outputs (different scan keys) where DLEQ proof is missing for one scan key",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQCAAAAAQYBAAABDiANAYhXLpMZbDaiIK8EGenGZRPMt6aZAtzaT/emYrkzEQEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih0Cri1sdi4oZ9SIAnccbS5oBt9dNzZiqcEigM8wuzUJoTohAtM5zzwmRB9JCHTI8hxbtJzGwH92iUNACITEjjgSMk+nIh4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwjIrwAAAAAAAAEEIlEgc+CGZ5pQmQJNADDkFVo8JXM2s3EKjtUsXx0+2E/BpOQBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsAAQMIyK8AAAAAAAABBCJRIAtNkigYZqv4xdhhlusryNSSUp09xiYEsKijHsszrgfuAQlCAq4tbHYuKGfUiAJ3HG0uaAbfXTc2YqnBIoDPMLs1CaE6A/I10XQ+qxFTs6TSFwcQ4J+2U0bL3iYunbKRAfg8KbgnAA==",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "0d0188572e93196c36a220af0419e9c66513ccb7a69902dcda4ff7a662b93311",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        },
        {
          "scan_pubkey": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "spend_pubkey": "03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        },
        {
          "scan_key": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "ecdh_result": "02d339cf3c26441f490874c8f21c5bb49cc6c07f768943400884c48e3812324fa7",
          "dleq_proof": null,
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "512073e086679a5099024d0030e4155a3c257336b3710a8ed52c5f1d3ed84fc1a4e4",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        },
        {
          "output_index": 1,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "51200b4d92281866abf8c5d86196eb2bc8d492529d3dc62604b0a8a31ecb33ae07ee",
          "sp_info": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with two inputs and two silent payment outputs (different scan keys) where input 1 is missing ECDH share for scan key B",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAIAAAABBQQCAAAAAQYBAAABDiCJVXthEW5b4fYMriZOLT3R8u1rnw7jrUwVk/47Bb0I+gEPBAAAAAABAR9QwwAAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YCIdAq4tbHYuKGfUiAJ3HG0uaAbfXTc2YqnBIoDPMLs1CaE6IQLTOc88JkQfSQh0yPIcW7ScxsB/dolDQAiExI44EjJPpyIeAq4tbHYuKGfUiAJ3HG0uaAbfXTc2YqnBIoDPMLs1CaE6QIdmku5EipFdXGSVqTF4D3qVVnTmOmZeJ5kKVBeP331qVKVYfh+Yc28h5WRKbW4zWp/+33d0nBj8rBnhDs6PQU4AAQ4gFzB8Xiialda/iXtUxsHAwl/6dy4l5h8yRf0a+2AS4MMBDwQAAAAAAQEfUMMAAAAAAAAWABRCHHFa7fmDrw47Z2/3xJTRBU/NugEQBP7///8iBgKPHQgtYAH6S6iZpAPa+bHbAb6SXCJTOvYw7mSTsL6feQQAAAAAAQMEAQAAACIdAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQNb6DQQKcckf6K5ONXUuFs6afvZMXutha9leZJx3LQoASIeAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4QMD+LMxS37uSW9P/ZUt6ltjsDgMaZ9BBtPmcsOgRSeKHqCvT1RvA/3M6zn0yq2PWEhhlRXeAj7LH+wbSvgb/OrYAAQMIyK8AAAAAAAABBCJRIAKrqMaAUEjbbEKbj6s18A39QsfViIiKIJUQq+ChLokkAQlCAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4Ak1Rg1P0vRjXac9o/2LvEGabcIYkawpkA/5XveSSEUSLAAEDCMivAAAAAAAAAQQiUSA8Z7JIA1z85MZSmif3m7bXBTIWuzXAdORgQzbO18YAbwEJQgKuLWx2Lihn1IgCdxxtLmgG3103NmKpwSKAzzC7NQmhOgPyNdF0PqsRU7Ok0hcHEOCftlNGy94mLp2ykQH4PCm4JwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "89557b61116e5be1f60cae264e2d3dd1f2ed6b9f0ee3ad4c1593fe3b05bd08fa",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        },
        {
          "input_index": 1,
          "private_key": "b0d095ddc9d046be37f1f083e2993b2c7ace820a0696c730d930a4eba61fc056",
          "public_key": "028f1d082d6001fa4ba899a403daf9b1db01be925c22533af630ee6493b0be9f79",
          "prevout_txid": "17307c5e289a95d6bf897b54c6c1c0c25ffa772e25e61f3245fd1afb6012e0c3",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        },
        {
          "scan_pubkey": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "spend_pubkey": "03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        },
        {
          "scan_key": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "ecdh_result": "02d339cf3c26441f490874c8f21c5bb49cc6c07f768943400884c48e3812324fa7",
          "dleq_proof": "876692ee448a915d5c6495a931780f7a955674e63a665e27990a54178fdf7d6a54a5587e1f98736f21e5644a6d6e335a9ffedf77749c18fcac19e10ece8f414e",
          "input_index": 0
        },
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "035be8341029c7247fa2b938d5d4b85b3a69fbd9317bad85af65799271dcb42801",
          "dleq_proof": "c0fe2ccc52dfbb925bd3ff654b7a96d8ec0e031a67d041b4f99cb0e81149e287a82bd3d51bc0ff733ace7d32ab63d61218654577808fb2c7fb06d2be06ff3ab6",
          "input_index": 1
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "512002aba8c6805048db6c429b8fab35f00dfd42c7d588888a209510abe0a12e8924",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        },
        {
          "output_index": 1,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "51203c67b248035cfce4c6529a27f79bb6d7053216bb35c074e4604336ced7c6006f",
          "sp_info": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    },
    {
      "description": "Reject PSBT with two silent payment outputs (different scan keys) where DLEQ proof is invalid for one scan key",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQCAAAAAQYBAAABDiCLp/007fM5/9amiAiw2NvcxXXrm0QbPZmjRhfNDkGQ0gEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih0Cri1sdi4oZ9SIAnccbS5oBt9dNzZiqcEigM8wuzUJoTohAtM5zzwmRB9JCHTI8hxbtJzGwH92iUNACITEjjgSMk+nIh4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YCIeAq4tbHYuKGfUiAJ3HG0uaAbfXTc2YqnBIoDPMLs1CaE6QNpl28vp+2DHQGus/WSo323Rr6YC+Su9BYwe53KTun7gXzG9kPuJWm9rOYh4N3HJhLLCaJeu3pc+du5/bolbcRkAAQMIyK8AAAAAAAABBCJRIDhW2Em+OIhxHLTLYddKqfOL1MrkPEFYB6JUZCx4ZaMIAQlCAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4Ak1Rg1P0vRjXac9o/2LvEGabcIYkawpkA/5XveSSEUSLAAEDCMivAAAAAAAAAQQiUSD/sFzu22qw5Ttuux31kNtScl+Ie5k5zyzbOS+KouavTAEJQgKuLWx2Lihn1IgCdxxtLmgG3103NmKpwSKAzzC7NQmhOgPyNdF0PqsRU7Ok0hcHEOCftlNGy94mLp2ykQH4PCm4JwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "8ba7fd34edf339ffd6a68808b0d8dbdcc575eb9b441b3d99a34617cd0e4190d2",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        },
        {
          "scan_pubkey": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "spend_pubkey": "03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        },
        {
          "scan_key": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a",
          "ecdh_result": "02d339cf3c26441f490874c8f21c5bb49cc6c07f768943400884c48e3812324fa7",
          "dleq_proof": "da65dbcbe9fb60c7406bacfd64a8df6dd1afa602f92bbd058c1ee77293ba7ee05f31bd90fb895a6f6b3988783771c984b2c26897aede973e76ee7f6e895b7119",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "51203856d849be3888711cb4cb61d74aa9f38bd4cae43c415807a254642c7865a308",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        },
        {
          "output_index": 1,
          "amount": 45000,
          "is_silent_payment": true,
          "script": "5120ffb05ceedb6ab0e53b6ebb1df590db52725f887b9939cf2cdb392f8aa2e6af4c",
          "sp_info": "02ae2d6c762e2867d48802771c6d2e6806df5d373662a9c12280cf30bb3509a13a03f235d1743eab1153b3a4d2170710e09fb65346cbde262e9db29101f83c29b827",
          "sp_label": null
        }
      ],
      "expected_psbt_id": null
    }
  ],
  "valid": [
    {
      "description": "Valid PSBT where a single entity controls all inputs and uses the global ECDH share approach (PSBT_GLOBAL_SP_ECDH_SHARE) for efficiency",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQBAAAAAQYBACIHAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQJVFk55JtUNUqCf+ZBkel6Vwdsb/GimFvvC2iE5J/mL/yIIAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4QMHWfzh4gr+BeRXqFYIdZNWzg1wfwFxVjOPYJJKhfZCMEEh9u5vdwQgMjC2cGXGyZgg8aQVOIhk/JEEorGZzfmAAAQ4gbprLPJXWyu5NSnIlAmnrjz0Fcu1PhPS3/DOpmr4+OgUBDwQAAAAAAQEfoIYBAAAAAAAWABT42vdq2AOw76ldbP+K7giR068cjAEQBP7///8iBgPTV/fAcY8keOP9j4zMJynd2MDMrrHwKxgab0TUO5+NjQQAAAAAAQMEAQAAAAABAwgYcwEAAAAAAAEEIlEgrhn77icwoalS19JZjMcD/d87lyslFIse0aea6HOdXgcBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "6e9acb3c95d6caee4d4a72250269eb8f3d0572ed4f84f4b7fc33a99abe3e3a05",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": null
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "5120ae19fbee2730a1a952d7d2598cc703fddf3b972b25148b1ed1a79ae8739d5e07",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": "7426a392bc7721ecf18a45699eafc3815bde7bb36558c5bd4cf9fbb140f1b745"
    },
    {
      "description": "Valid PSBT with multiple parties (two signers) where each signer contributes per-input ECDH shares (PSBT_IN_SP_ECDH_SHARE) for their respective inputs",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAIAAAABBQQBAAAAAQYBAAABDiBc+IxEpEzVImNhvtEHUZRvn4cJUikR4HeBX19/B4WvaQEPBAAAAAABAR9QwwAAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABDiAT0u662aEJkUdBDIam/gsg7p23WdpBz9Tul5LNUBI3FQEPBAAAAAABAR9QwwAAAAAAABYAFEIccVrt+YOvDjtnb/fElNEFT826ARAE/v///yIGAo8dCC1gAfpLqJmkA9r5sdsBvpJcIlM69jDuZJOwvp95BAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghA1voNBApxyR/ork41dS4Wzpp+9kxe62Fr2V5knHctCgBIh4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwP4szFLfu5Jb0/9lS3qW2OwOAxpn0EG0+Zyw6BFJ4oeoK9PVG8D/czrOfTKrY9YSGGVFd4CPssf7BtK+Bv86tgABAwgYcwEAAAAAAAEEIlEgC9xqHau4dRdnjCtffc3/KXbcXRE1xN2T9mcj6++5jiUBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "5cf88c44a44cd5226361bed10751946f9f8709522911e077815f5f7f0785af69",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        },
        {
          "input_index": 1,
          "private_key": "b0d095ddc9d046be37f1f083e2993b2c7ace820a0696c730d930a4eba61fc056",
          "public_key": "028f1d082d6001fa4ba899a403daf9b1db01be925c22533af630ee6493b0be9f79",
          "prevout_txid": "13d2eebad9a1099147410c86a6fe0b20ee9db759da41cfd4ee9792cd50123715",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        },
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "035be8341029c7247fa2b938d5d4b85b3a69fbd9317bad85af65799271dcb42801",
          "dleq_proof": "c0fe2ccc52dfbb925bd3ff654b7a96d8ec0e031a67d041b4f99cb0e81149e287a82bd3d51bc0ff733ace7d32ab63d61218654577808fb2c7fb06d2be06ff3ab6",
          "input_index": 1
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": "51200bdc6a1dabb87517678c2b5f7dcdff2976dc5d1135c4dd93f66723ebefb98e25",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": "d1fb3d430529b4fd80d33688d9ca6251a06470e52006dab24cbd1e948cad76af"
    },
    {
      "description": "Valid PSBT with incomplete ECDH coverage: 2 eligible inputs but only input 0 has ECDH share, no PSBT_OUT_SCRIPT field",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAIAAAABBQQBAAAAAQYBAAABDiAse9Mv8VBxwK4DJzhkoUNsilYhNWnhEy3Pjqc+yMMyIgEPBAAAAAABAR9QwwAAAAAAABYAFEIccVrt+YOvDjtnb/fElNEFT826ARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAAAEOIG9ebp3S5SnkMJ4TK1Ph9qmzCyvel42h519YLx86RDNmAQ8EAAAAAAEBH1DDAAAAAAAAFgAU+Nr3atgDsO+pXWz/iu4IkdOvHIwBEAT+////IgYCjx0ILWAB+kuomaQD2vmx2wG+klwiUzr2MO5kk7C+n3kEAAAAAAEDBAEAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CEDW+g0ECnHJH+iuTjV1LhbOmn72TF7rYWvZXmScdy0KAEiHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+EDA/izMUt+7klvT/2VLepbY7A4DGmfQQbT5nLDoEUnih6gr09UbwP9zOs59Mqtj1hIYZUV3gI+yx/sG0r4G/zq2AAEDCBhzAQAAAAAAAQlCAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4Ak1Rg1P0vRjXac9o/2LvEGabcIYkawpkA/5XveSSEUSLAA==",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "2c7bd32ff15071c0ae03273864a1436c8a56213569e1132dcf8ea73ec8c33222",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014421c715aedf983af0e3b676ff7c494d1054fcdba",
          "sequence": 4294967295
        },
        {
          "input_index": 1,
          "private_key": "b0d095ddc9d046be37f1f083e2993b2c7ace820a0696c730d930a4eba61fc056",
          "public_key": "028f1d082d6001fa4ba899a403daf9b1db01be925c22533af630ee6493b0be9f79",
          "prevout_txid": "6f5e6e9dd2e529e4309e132b53e1f6a9b30b2bde978da1e75f582f1f3a443366",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 50000,
          "witness_utxo": "50c3000000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "035be8341029c7247fa2b938d5d4b85b3a69fbd9317bad85af65799271dcb42801",
          "dleq_proof": "c0fe2ccc52dfbb925bd3ff654b7a96d8ec0e031a67d041b4f99cb0e81149e287a82bd3d51bc0ff733ace7d32ab63d61218654577808fb2c7fb06d2be06ff3ab6",
          "input_index": 1
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 95000,
          "is_silent_payment": true,
          "script": null,
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": "d42acce8e326f42470654e550294c46fdaf6484a676373de4b73e188f0d5daa9"
    },
    {
      "description": "Valid PSBT sending from P2WPKH to silent payment address with change output, using PSBT_OUT_SP_V0_LABEL for labeled silent payment and PSBT_OUT_BIP32_DERIVATION for change identification",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQCAAAAAQYBAAABDiAlbK6m2hWAb7hW7a50mI1EDHqxtcCGHsgR0ZCSdHudHAEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPghAlUWTnkm1Q1SoJ/5kGR6XpXB2xv8aKYW+8LaITkn+Yv/Ih4C0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPhAwdZ/OHiCv4F5FeoVgh1k1bODXB/AXFWM49gkkqF9kIwQSH27m93BCAyMLZwZcbJmCDxpBU4iGT8kQSisZnN+YAABAwhQwwAAAAAAAAEEIlEgVbkWS8N9yG9biTYWgqowiLWz+lPa20PpXxvRE5uxwDUBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgD9SRDSFIBZWa8RdH6alxaGGLN2TPxXIQ7QnI4IvUlMjcBCgQBAAAAAAEDCMivAAAAAAAAAQQWABTjwxDMKvOsbmLK5L0j4+5SueHJWSICA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NDAAAAAAAAAAAAAAAAQA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "256caea6da15806fb856edae74988d440c7ab1b5c0861ec811d19092747b9d1c",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": 1
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 50000,
          "is_silent_payment": true,
          "script": "512055b9164bc37dc86f5b89361682aa3088b5b3fa53dadb43e95f1bd1139bb1c035",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f803f524434852016566bc45d1fa6a5c5a1862cdd933f15c843b42723822f5253237",
          "sp_label": 1
        },
        {
          "output_index": 1,
          "amount": 45000,
          "is_silent_payment": false,
          "script": "0014e3c310cc2af3ac6e62cae4bd23e3ee52b9e1c959",
          "sp_info": null,
          "sp_label": null
        }
      ],
      "expected_psbt_id": "ab25647f98c2743f8e036a45d84e3cdd5f6a6ca646fd9d008628baa33b58cc9a"
    },
    {
      "description": "Valid PSBT demonstrating BIP-352 label=0 convention for silent payments change where output 0 (recipient) has no PSBT_OUT_SP_V0_LABEL field and output 1 (change) has PSBT_OUT_SP_V0_LABEL=0",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQCAAAAAQYBAAABDiA+pBZO0PMkTo553UGS7UdFpGOtOryyjdXpggKGignYwgEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAABAwQBAAAAIh0C0OfeGchVFsg+GTiVlfzEqqKAjJ1du0glc7WJ2w1NQ/shA0gH+Gwlms4ep9JpUwu5fXthzHLUW7wA9lYwGZ13C29pIh4C0OfeGchVFsg+GTiVlfzEqqKAjJ1du0glc7WJ2w1NQ/tAlgCZCmLP09s3tvbjnI0L2vy1Ki3DtuzSjzG4VK5eKT9BlW79Yg/B4BXnnbr05J2dnu4/CGMbe3hNv8F28mS4wiIdAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQJVFk55JtUNUqCf+ZBkel6Vwdsb/GimFvvC2iE5J/mL/yIeAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4QMHWfzh4gr+BeRXqFYIdZNWzg1wfwFxVjOPYJJKhfZCMEEh9u5vdwQgMjC2cGXGyZgg8aQVOIhk/JEEorGZzfmAAAQMIQJwAAAAAAAABBCJRIGeR5WTAN8T4IAgi1ORFG+koagPKf1WKnsktXs8Z/HpBAQlCAtDn3hnIVRbIPhk4lZX8xKqigIydXbtIJXO1idsNTUP7A2Wqwj6pXfjI9HO7Wrun1Y4o07RqNBkb1AlcbdXmrXNBAAEDCNjWAAAAAAAAAQQiUSCnrlZnvJt3KzCgIt0kbliQzC07gBLEBu4jSFg5rqtqgQEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+ANUNPp9mrroXxiv7ibhb7t4iMiMVuP5P17uTcDvlI+lxAEKBAAAAAAA",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "3ea4164ed0f3244e8e79dd4192ed4745a463ad3abcb28dd5e98202868a09d8c2",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "035434fa7d9abae85f18afee26e16fbb7888c88c56e3f93f5eee4dc0ef948fa5c4",
          "label": 0
        },
        {
          "scan_pubkey": "02d0e7de19c85516c83e19389595fcc4aaa2808c9d5dbb482573b589db0d4d43fb",
          "spend_pubkey": "0365aac23ea95df8c8f473bb5abba7d58e28d3b46a34191bd4095c6dd5e6ad7341",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d0e7de19c85516c83e19389595fcc4aaa2808c9d5dbb482573b589db0d4d43fb",
          "ecdh_result": "034807f86c259ace1ea7d269530bb97d7b61cc72d45bbc00f65630199d770b6f69",
          "dleq_proof": "9600990a62cfd3db37b6f6e39c8d0bdafcb52a2dc3b6ecd28f31b854ae5e293f41956efd620fc1e015e79dbaf4e49d9d9eee3f08631b7b784dbfc176f264b8c2",
          "input_index": 0
        },
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 40000,
          "is_silent_payment": true,
          "script": "51206791e564c037c4f8200822d4e4451be9286a03ca7f558a9ec92d5ecf19fc7a41",
          "sp_info": "02d0e7de19c85516c83e19389595fcc4aaa2808c9d5dbb482573b589db0d4d43fb0365aac23ea95df8c8f473bb5abba7d58e28d3b46a34191bd4095c6dd5e6ad7341",
          "sp_label": null
        },
        {
          "output_index": 1,
          "amount": 55000,
          "is_silent_payment": true,
          "script": "5120a7ae5667bc9b772b30a022dd246e5890cc2d3b8012c406ee23485839aeab6a81",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8035434fa7d9abae85f18afee26e16fbb7888c88c56e3f93f5eee4dc0ef948fa5c4",
          "sp_label": 0
        }
      ],
      "expected_psbt_id": "5e99323fe3915bd35f51c06faea14e0f513e1b697458bb179774992c729c704d"
    },
    {
      "description": "Valid PSBT with multiple silent payment outputs to the same scan key, using different k values to generate distinct output scripts",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAEAAAABBQQCAAAAAQYBACIHAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4IQJVFk55JtUNUqCf+ZBkel6Vwdsb/GimFvvC2iE5J/mL/yIIAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4QMHWfzh4gr+BeRXqFYIdZNWzg1wfwFxVjOPYJJKhfZCMEEh9u5vdwQgMjC2cGXGyZgg8aQVOIhk/JEEorGZzfmAAAQ4gLHvTL/FQccCuAyc4ZKFDbIpWITVp4RMtz46nPsjDMiIBDwQAAAAAAQEfoIYBAAAAAAAWABT42vdq2AOw76ldbP+K7giR068cjAEQBP7///8iBgPTV/fAcY8keOP9j4zMJynd2MDMrrHwKxgab0TUO5+NjQQAAAAAAQMEAQAAAAABAwhAnAAAAAAAAAEEIlEg+ytxOv1SuiRxgbmYQapPLIhVut99rOLrLjBV2hPuK4wBCUIC0Cn/lt4svPeCvkNZxIYg6pK83WvvAyuVFYuRoWk/tPgCTVGDU/S9GNdpz2j/Yu8QZptwhiRrCmQD/le95JIRRIsAAQMI2NYAAAAAAAABBCJRIFmgqeG9mJh0IBNVOGDtC0S3JvvFIOnFcbxGSV8kefYYAQlCAtAp/5beLLz3gr5DWcSGIOqSvN1r7wMrlRWLkaFpP7T4Ak1Rg1P0vRjXac9o/2LvEGabcIYkawpkA/5XveSSEUSLAA==",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "2c7bd32ff15071c0ae03273864a1436c8a56213569e1132dcf8ea73ec8c33222",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 40000,
          "is_silent_payment": true,
          "script": "5120fb2b713afd52ba247181b99841aa4f2c8855badf7dace2eb2e3055da13ee2b8c",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        },
        {
          "output_index": 1,
          "amount": 55000,
          "is_silent_payment": true,
          "script": "512059a0a9e1bd9898742013553860ed0b44b726fbc520e9c571bc46495f2479f618",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": "31dbed50c7a29799aaf16d3adec754819269ca69e8102ecad4231d1d64f2727b"
    },
    {
      "description": "Valid PSBT with mixed input types where only eligible P2WPKH inputs contribute ECDH shares (ineligible P2SH multisig excluded)",
      "psbt": "cHNidP8B+wQCAAAAAQIEAgAAAAEEBAIAAAABBQQBAAAAAQYBAAABDiApw6Peut1f6dS0XD295x0CWioK+UM7tO+6i0Pv5za0oQEPBAAAAAABAR+ghgEAAAAAABYAFPja92rYA7DvqV1s/4ruCJHTrxyMARAE/v///yIGA9NX98BxjyR44/2PjMwnKd3YwMyusfArGBpvRNQ7n42NBAAAAAAiHQLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+CECVRZOeSbVDVKgn/mQZHpelcHbG/xophb7wtohOSf5i/8iHgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+EDB1n84eIK/gXkV6hWCHWTVs4NcH8BcVYzj2CSSoX2QjBBIfbub3cEIDIwtnBlxsmYIPGkFTiIZPyRBKKxmc35gAAEOILbM9qpt6XebBi77G8FTHGWl57KukFWmYqsFQG8N9EfUAQ8EAAAAAAEQBP7///8BAFMCAAAAAeQ/TH2g2e+DCDNBekstaV4FoHWp1MBWN7X86t8ZX5WyAAAAAAD/////AfBJAgAAAAAAF6kUY3evt1S5inYSGc8WdvySwjeEULaHAAAAAAEER1IhAo8dCC1gAfpLqJmkA9r5sdsBvpJcIlM69jDuZJOwvp95IQM1iX7FrnBP5V2OpdRnsK69s3mb4Qw2BHHZt4nIEa/eO1KuAAEDCJBfAQAAAAAAAQQiUSDsAiz0NrWnm7cXwbLngQA8S0LMDyzAhBLXhwYsyqNHgwEJQgLQKf+W3iy894K+Q1nEhiDqkrzda+8DK5UVi5GhaT+0+AJNUYNT9L0Y12nPaP9i7xBmm3CGJGsKZAP+V73kkhFEiwA=",
      "input_keys": [
        {
          "input_index": 0,
          "private_key": "e75f1990643539150761b0dc9eceb2ec0cf8636883eea2112d991dec3567a7b9",
          "public_key": "03d357f7c0718f2478e3fd8f8ccc2729ddd8c0ccaeb1f02b181a6f44d43b9f8d8d",
          "prevout_txid": "29c3a3debadd5fe9d4b45c3dbde71d025a2a0af9433bb4efba8b43efe736b4a1",
          "prevout_index": 0,
          "prevout_scriptpubkey": "0014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "amount": 100000,
          "witness_utxo": "a086010000000000160014f8daf76ad803b0efa95d6cff8aee0891d3af1c8c",
          "sequence": 4294967295
        },
        {
          "input_index": 1,
          "private_key": "b0d095ddc9d046be37f1f083e2993b2c7ace820a0696c730d930a4eba61fc056",
          "public_key": "028f1d082d6001fa4ba899a403daf9b1db01be925c22533af630ee6493b0be9f79",
          "prevout_txid": "b6ccf6aa6de9779b062efb1bc1531c65a5e7b2ae9055a662ab05406f0df447d4",
          "prevout_index": 0,
          "prevout_scriptpubkey": "a9146377afb754b98a761219cf1676fc92c2378450b687",
          "amount": 150000,
          "witness_utxo": "0200000001e43f4c7da0d9ef830833417a4b2d695e05a075a9d4c05637b5fceadf195f95b20000000000ffffffff01f04902000000000017a9146377afb754b98a761219cf1676fc92c2378450b68700000000",
          "sequence": 4294967295
        }
      ],
      "scan_keys": [
        {
          "scan_pubkey": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "spend_pubkey": "024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "label": null
        }
      ],
      "expected_ecdh_shares": [
        {
          "scan_key": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8",
          "ecdh_result": "0255164e7926d50d52a09ff990647a5e95c1db1bfc68a616fbc2da213927f98bff",
          "dleq_proof": "c1d67f387882bf817915ea15821d64d5b3835c1fc05c558ce3d82492a17d908c10487dbb9bddc1080c8c2d9c1971b266083c69054e22193f244128ac66737e60",
          "input_index": 0
        }
      ],
      "expected_outputs": [
        {
          "output_index": 0,
          "amount": 90000,
          "is_silent_payment": true,
          "script": "5120ec022cf436b5a79bb717c1b2e781003c4b42cc0f2cc08412d787062ccaa34783",
          "sp_info": "02d029ff96de2cbcf782be4359c48620ea92bcdd6bef032b95158b91a1693fb4f8024d518353f4bd18d769cf68ff62ef10669b7086246b0a6403fe57bde49211448b",
          "sp_label": null
        }
      ],
      "expected_psbt_id": "ac244530441de4343ba8fe12cdf4f2e660ff9ab866b5ffedc214ba4c8141c577"
    }
  ]
}